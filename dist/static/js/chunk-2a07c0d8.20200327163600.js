(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a07c0d8"],{"051d":function(e,t,i){"use strict";var r=i("3788"),a=i.n(r);a.a},"08a4":function(e,t,i){e.exports=i.p+"static/img/default-poster@2x.f3a17f3f.png"},1960:function(e,t,i){e.exports=i.p+"static/img/icon_sign_empty.71fdc936.png"},1964:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"share-player-container",class:{vertical:e.vertical}},[0!==+e.options.liveStatus||e.vertical?e._e():r("div",{directives:[{name:"show",rawName:"v-show",value:!e.isError,expression:"!isError"}],staticClass:"not-start-container"},[e.vertical?e._e():r("div",{staticClass:"not-start-wrapper"},[r("h1",{staticClass:"live-room-name"},[e._v(e._s(e.options.liveTitle))]),r("div",{staticClass:"text-mid"},[e._v("距离开始还有")]),r("div",{staticClass:"live-clock"},[e._v(e._s(e.clockText))])]),r("img",{staticClass:"bg",attrs:{src:e.options.poster,alt:""}})]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isError,expression:"isError"}],staticClass:"player-error-msg",class:{horizontal:!e.vertical}},[r("div",[r("img",{staticClass:"icon",attrs:{src:i("79b1"),alt:""}}),r("p",[e._v(e._s(e.errorMsg))])])]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showPlayBtn,expression:"showPlayBtn"}],staticClass:"vertical-player",class:{vertical:e.vertical,hidden:1!==+e.options.liveStatus},on:{click:function(t){return t.target!==t.currentTarget?null:e.togglePlay(t)}}}),r("div",{staticClass:"share-player-wrapper",attrs:{id:"share-player-wrapper"}})])},a=[],n=(i("163d"),i("08a4")),s=i.n(n),o=i("fe7f"),c=i.n(o),l={name:"vPlayer",props:{errorCode:{type:Number,default:0},vertical:{type:Boolean,default:!1},options:{type:Object}},data:function(){return{player:null,showPlayBtn:!0,isError:this.errorCode>0,nowTime:Date.now()}},watch:{errorCode:function(e){this.isError=e>0}},computed:{errorMsg:function(){var e="";switch(this.errorCode){case 1:e="直播已结束";break;case 2:e="准备中，请晚点再来";break;case 3:e="网络似乎中断了，请检查网络设置";break}return e},clockText:function(){var e=this.options.liveBeginTime,t=this.nowTime,i=new Date(e),r=parseInt((i-t)/1e3),a=parseInt(r/86400),n=parseInt(r%86400/3600),s=parseInt(r%86400%3600/60),o=parseInt(r%86400%3600%60),c="";return a>0&&(c="".concat(a,"天 ")),"".concat(c).concat(n>=10?n:"0"+n,":").concat(s>=10?s:"0"+s,":").concat(o>=10?o:"0"+o)}},methods:{initPlayer:function(){var e=this;this.$nextTick((function(){var t=e.options,i=t.src,r=t.autoplay,a=void 0!==r&&r,n=t.volume,o=void 0===n?1:n,l=t.liveStatus,u=void 0===l?0:l,d=e.options.poster||(e.vertical?c.a:s.a);e.player=new window.TcPlayer("share-player-wrapper",{m3u8:i,poster:{style:"stretch",src:d},controls:e.vertical?"none":"default",autoplay:a,live:1*u===1,volume:o,pausePosterEnabled:!1,x5_orientation:1,x5_player:!1,systemFullscreen:!0,x5_fullscreen:"true",listener:function(t){"error"===t.type.toLowerCase()&&(e.isError=!0,"no live"!==i&&e.$emit("onError",t)),"playing"===t.type.toLowerCase()&&(e.showPlayBtn=!1,e.$emit("onPlay")),"pause"===t.type.toLowerCase()&&(e.showPlayBtn=!0,e.$emit("onPause"))}}),e.player.video.el.setAttribute("x5-playsinline",!0),e.vertical&&e.player.video.el.setAttribute("x5-video-player-type","h5"),1!==u&&e.changeClock(),e.handleVisibilityChange()}))},togglePlay:function(){this.player.togglePlay()},changeClock:function(){var e=this,t=setTimeout((function(){e.nowTime=Date.now(),clearTimeout(t),e.nowTime<new Date(e.options.liveBeginTime)||1!==e.options.liveStatus?(e.changeClock(),e.$emit("countDownRun")):e.$emit("countDownOver")}),1e3)},handleVisibilityChange:function(){var e,t,i=this;"undefined"!==typeof document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==typeof document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),document.addEventListener(t,(function(){document[e]?i.player.pause():i.player.play()}),!1)}},mounted:function(){var e=this;this.$nextTick((function(){e.initPlayer()}))}},u=l,d=(i("4eb9"),i("623f")),p=Object(d["a"])(u,r,a,!1,null,null,null);t["a"]=p.exports},"2a8f":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"horizontal-container"},[e.playerOpt.src?i("vPlayer",{ref:"player",attrs:{options:e.playerOpt,"error-code":e.errorCode},on:{onError:e.playError,onPlay:e.playStart,countDownRun:e.countDownRun,onPause:e.playPause}}):e._e(),i("div",{staticClass:"scroll-box-container"},[i("vTabbar",{attrs:{items:e.tabbarItems},on:{change:e.onTabbarChange}}),i("div",{staticClass:"scroll-box-wrapper"},[i("keep-alive",[e.isInit||e.isOld?i(e.componentId,{ref:"current-message",tag:"component",attrs:{"live-introduction":e.desc,vodlist:e.vodList,"play-info":{livebackground:e.playerOpt.poster},initData:e.imInitData},on:{toplay:e.loadVideo,sendGift:function(t){return e.setRewardVisible(1)}}}):e._e()],1)],1)],1),i("reward",{attrs:{rewardShow:e.rewardShow,rewardType:2},on:{setRewardVisible:e.setRewardVisible,paySuc:e.updateIMItem}}),i("div",{staticClass:"reward-fixed",on:{click:function(t){return e.setRewardVisible(1)}}},[e._v("打赏")])],1)},a=[],n=(i("5ab2"),i("6d57"),i("e10e"),i("ed63"),i("8cf2"),i("419a"),i("e980")),s=i("ac9f"),o=i("1964"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tabbar-container"},[i("ul",{staticClass:"tabbar-wrapper"},e._l(e.items,(function(t){return i("li",{key:t.value,staticClass:"tabbar-item",class:{selected:e.selectedItem===t.value},on:{click:function(i){return e.change(t.value)}}},[i("span",{staticClass:"item-text"},[e._v(e._s(t.label))])])})),0)])},l=[],u={name:"vTabbar",props:{items:{type:Array,default:function(){return[{label:"互动",value:1},{label:"简介",value:2}]}}},data:function(){return{selectedItem:1}},methods:{change:function(e){this.selectedItem!==e&&(this.selectedItem=e,this.$emit("change",e))}}},d=u,p=(i("e02d"),i("623f")),f=Object(p["a"])(d,c,l,!1,null,"d79a0fc0",null),h=f.exports,m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.rewardShow&&e.resFlag,expression:"rewardShow && resFlag"}],staticClass:"reward-model",on:{click:function(t){return t.target!==t.currentTarget?null:e.modelToggle(t)}}},[i("div",{staticClass:"reward-wrapper"},[i("div",{staticClass:"reward-title"},[e._v("\n                喜欢老师\n                "),i("div",{staticClass:"reward-close",on:{click:function(t){return t.target!==t.currentTarget?null:e.modelToggle(t)}}})]),i("ul",[i("li",{staticClass:"flex-row"},e._l(e.dataList,(function(t,r){return i("div",{key:r,staticClass:"gift-box"},[i("div",{class:t.giftClass,on:{click:function(i){return e.getRewardOrder(r,t)}}},[i("img",{staticClass:"reward-img",attrs:{src:t.image.imageUrl,alt:""}}),i("p",{directives:[{name:"show",rawName:"v-show",value:!t.selected,expression:"!item.selected"}],staticClass:"ellipsis gift-name"},[e._v(e._s(t.name))]),i("p",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"item.selected"}],staticClass:"ellipsis gift-name"},[e._v(e._s(t.priceTxt)+"￥")]),i("p",{staticClass:"price"},[e._v(e._s(t.priceTxt)+"￥")]),i("div",{staticClass:"selected-bottom"},[e._v("赠送")])])])})),0)]),e._m(0)]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.loadingFlag,expression:"loadingFlag"}],staticClass:"reward-loading"},[i("van-loading",{attrs:{size:"40px",color:"#fff"}}),i("div",{staticStyle:{color:"#fff","font-size":"16px","padding-top":"10px"}},[e._v("支付中...")])],1)])},v=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex-row price-desc"},[i("div",{staticClass:"desc-icon"}),i("p",[e._v("1元=1掌通币")])])}],g=(i("cc57"),i("9e76"),i("163d"),i("365c")),y=i("cf45"),w=i("b27f"),I={name:"reward",props:{rewardType:{type:Number,default:2},rewardShow:{type:Number,default:0}},data:function(){return{resFlag:!1,loadingFlag:!1,giftClass:"gift-border",isShowReward:this.rewardShow,dataList:[],imInfo:{},orderInfo:"",statusInfo:"",statusQueryNum:0,objId:"",osType:1,eventWords:"gift"}},computed:{},created:function(){this.eventWords=1*this.rewardType===1?"gift":"redpacket";var e=navigator.userAgent,t=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);this.osType=t?2:1},mounted:function(){var e=this;this.$nextTick((function(){e.getRewardList()}))},methods:{modelToggle:function(){this.isShowReward=0,this.$emit("setRewardVisible",this.isShowReward)},getRewardList:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={shopId:y["a"].getUrl("liveId")||"1",anchorId:y["a"].getUrl("anchorId")||"1",anchorType:y["a"].getUrl("anchorType")||1,giftType:this.rewardType},e.prev=1,e.next=4,g["d"].getRewardList(t);case 4:this.dataList=e.sent.data,this.dataList.forEach((function(e,t){e.selected=0,e.giftClass="gift-border"})),this.resFlag=!0,console.log(this.dataList),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(){return e.apply(this,arguments)}return t}(),getRewardOrder:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,i){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("getRewardOrder"),this.dataList.forEach((function(e,t){e.selected=0,e.giftClass="gift-border"})),this.$set(this.dataList[t],"giftClass","gift-border selected"),this.imInfo=this.dataList[t],this.dataList[t].selected=1,this.$forceUpdate(),this.loadingFlag=!0,this.objId=y["a"].getUrl("liveId")+";"+this.imInfo.giftId,this.szyEv({event_id:"click_openclass_"+this.eventWords+"_choose",obj_id:this.objId,parm:{gift:t}}),r="",window.localStorage.getItem("wx_user_info")&&(r=JSON.parse(window.localStorage.getItem("wx_user_info"))),a={giftId:i.giftId,giftNum:1,rewardUser:r.openid||"wx58264a82c91f879b",nickName:r.nickname,userPic:{imageUrl:r.headimgurl,weight:"",height:""},platform:0,osType:this.osType,shopId:y["a"].getUrl("liveId")||1,shopName:y["a"].getUrl("shopName"),anchorId:y["a"].getUrl("anchorId")||"1",anchorType:y["a"].getUrl("anchorType")||1},e.prev=12,e.next=15,g["d"].getRewardOrder(a);case 15:this.orderInfo=e.sent,n={appId:this.orderInfo.h5PayParams.appId,timestamp:this.orderInfo.h5PayParams.timestamp,nonceStr:this.orderInfo.h5PayParams.nonceStr,package:this.orderInfo.h5PayParams.pk,signType:this.orderInfo.h5PayParams.signType,paySign:this.orderInfo.h5PayParams.sign,success:this.paySuccess,canel:this.payCanel,fail:this.payFail},this.onBridgeReady(n),e.next=26;break;case 20:e.prev=20,e.t0=e["catch"](12),console.log(e.t0),this.loadingFlag=!1,this.$toast(e.t0),this.modelToggle();case 26:case"end":return e.stop()}}),e,this,[[12,20]])})));function t(t,i){return e.apply(this,arguments)}return t}(),QuertRewardOrderStatus:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.statusQueryNum++,t={orderId:this.orderInfo.orderId||1,tradeNo:this.orderInfo.tradeNo||1},e.prev=2,e.next=5,g["d"].QuertRewardOrderStatus(t);case 5:this.statusInfo=e.sent,console.log(this.statusInfo),1*this.statusInfo.tradeStatus===1?(this.loadingFlag=!1,this.modelToggle(),this.$toast("支付成功"),i={msgInfo:{type:5,body:{streamId:y["a"].getUrl("streamId"),giftId:this.imInfo.giftId,giftType:this.imInfo.giftType,imageUrl:this.imInfo.image.imageUrl,priceType:this.imInfo.priceType,price:this.imInfo.price,priceTxt:this.imInfo.priceTxt,cnt:1,textContent:this.imInfo.name}}},console.log(this.paramIM),this.$emit("paySuc",i)):this.statusQueryNum<4?Object(w["setTimeout"])((function(){r.QuertRewardOrderStatus()}),1e3):this.$toast("订单支付失败，请联系掌通家园客服处理"),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0),this.$toast(e.t0||"订单状态失败败"),console.log("订单状态失败=====");case 15:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(){return e.apply(this,arguments)}return t}(),paySuccess:function(){var e=this;this.szyEv({event_id:"openclass_"+this.eventWords+"_pay_suc",obj_id:this.objId}),Object(w["setTimeout"])((function(){e.QuertRewardOrderStatus()}),1e3)},payCanel:function(){alert("取消支付123"),this.loadingFlag=!1,this.szyEv({event_id:"openclass_"+this.eventWords+"_pay_cancel",obj_id:this.objId})},payFail:function(){alert("微信支付失败456"),this.loadingFlag=!1,this.szyEv({event_id:"openclass_"+this.eventWords+"_pay_fail",obj_id:this.objId}),console.log("微信支付失败567888")},szyEv:function(e){this.$szyreport.reportEvent({data:e,prefix:""})},onBridgeReady:function(e){var t=this;window.WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timestamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign},(function(e){alert(JSON.stringify(e.err_msg)+"======="),"get_brand_wcpay_request:ok"===e.err_msg?t.paySuccess():e.err_msg.indexOf("canel")>-1?t.payCanel():t.payFail()}))}}},b=I,_=(i("3c3f"),Object(p["a"])(b,m,v,!1,null,"2e02277b",null)),T=_.exports,x=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"intro-container"},[e.liveIntroduction?i("div",{staticClass:"intro",domProps:{innerHTML:e._s(e.liveIntroduction)}}):i("div",{staticClass:"empty"},[i("img",{attrs:{src:e.nodataimg,alt:""}}),i("p",[e._v("该内容暂无简介")])])])},C=[],O={props:{liveIntroduction:{default:""}},data:function(){return{nodataimg:i("2cb0")}},methods:{}},S=O,k=(i("54f0"),Object(p["a"])(S,x,C,!1,null,"4a15ac19",null)),P=k.exports,R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vod-container"},[e.vodlist.length>0?i("div",e._l(e.vodlist,(function(t,r){return i("div",{key:r,staticClass:"vodlist",on:{click:function(i){return e.toplay(t)}}},[i("div",{staticClass:"vodlistpic"},[i("img",{attrs:{src:e.playInfo.livebackground+"?imageView2/5/w/672/h/432",alt:""}}),i("p",{staticClass:"vodlisttime"},[e._v(e._s(t.time))])]),i("div",{staticClass:"vodlistTitle"},[i("p",[e._v(e._s(t.vodtitle))])])])})),0):e._e(),0==e.vodlist.length?i("div",{staticClass:"empty"},[i("img",{attrs:{src:e.nodataimg,alt:""}}),i("p",[e._v("哎呀，没有可观看的内容")])]):e._e()])},j=[],D={props:{vodlist:{type:Array,default:function(){return[]}},playInfo:{type:Object,default:function(){return{}}}},data:function(){return{nodatashow:!1,nodataimg:i("2cb0")}},methods:{toplay:function(e){this.$emit("toplay",{watchType:1,item:e})}}},E=D,N=(i("3a2f"),Object(p["a"])(E,R,j,!1,null,"5338fa42",null)),L=N.exports,$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"interactive-container"},[i("div",{staticClass:"clearfix interactive-top"},[e._m(0),i("div",{attrs:{id:"lookNum"}},[e._v("观看人数"+e._s(e.commonparams.liveAudiences))])]),i("van-pull-refresh",{staticStyle:{padding:"1rem 0 2.4rem 0"},on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[i("van-list",{attrs:{finished:e.finished,offset:300,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[i("div",{staticClass:"commentList-box"},[i("ul",{attrs:{id:"commentList"}},e._l(e.list,(function(t,r){return i("li",{key:r,staticClass:"clearfix"},[i("div",{staticClass:"comment-left"},[i("img",{attrs:{src:t.userPic+"?imageView2/1/w/80/h/80"}})]),i("div",{staticClass:"comment-right"},[i("div",{staticClass:"cr-box clearfix"},[i("div",{staticClass:"cr-left"},[i("div",{staticClass:"crl-top"},[t.isTeacher?i("i",[e._v("教师")]):e._e(),i("span",[e._v(e._s(t.userName))])]),i("div",{staticClass:"crl-mid"},[e._v(e._s(t.content))])]),i("div",{staticClass:"cr-right"},[1==t.likeState?[i("i",{staticClass:"icon-heart active"}),i("span",{staticClass:"active"},[e._v(e._s(t.likeCount))])]:[i("i",{staticClass:"icon-heart"}),i("span",[e._v(e._s(t.likeCount))])]],2)]),i("div",{staticClass:"cr-bottom clearfix"},[i("div",{staticClass:"crl-bottom"},[e._v(e._s(t.createTimeStr))]),e.curuserId==t.userId?i("div",{staticClass:"crl-delete"},[e._v("删除")]):e._e()])])])})),0)])])],1),e.nodatashow?i("div",{staticClass:"empty"},[i("img",{attrs:{src:e.nodataimg,alt:""}}),i("p",[e._v("还没人给老师留言，快来参加互动吧")])]):e._e()],1)},U=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"hot-title"},[i("span",[e._v("全部")]),i("i",{staticClass:"hot-icon"})])}],M=i("4d5e"),F=i("08c1");function V(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function z(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?V(Object(i),!0).forEach((function(t){Object(s["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):V(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var A={data:function(){return{list:[],nodataimg:i("1960"),teacherimg:i("4fd6"),dadimg:i("5c95"),momimg:i("303c"),refreshing:!1,loading:!1,error:!1,finished:!1,nodatashow:!1,flag:!1,commonparams:{},realuserType:"",pageNo:1,pageSize:8,userInfo:{},curuserId:""}},created:function(){},mounted:function(){},computed:{},methods:z({},Object(F["b"])({getUserInfo:"User/getUserInfo"}),{dealImg:function(e){var t;return t=e.avatar?e.avatar:"parent"===M["c"]?"male"===e.userSex?this.dadimg:this.momimg:this.teacherimg,t},dealUserType:function(e){M["c"]&&("parent"===M["c"]?e.user_type&&(this.realuserType=e.user_type):"2"===e.user_type?this.realuserType=5:"3"===e.user_type&&(this.realuserType=4))},onLoad:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.nodatashow=!1,this.loading=!0,this.flag){e.next=13;break}return e.next=5,this.getUserInfo();case 5:return this.userInfo=e.sent,this.curuserId=this.userInfo?this.userInfo.uid:"",this.dealUserType(this.userInfo),e.next=10,g["c"].getCommentPageParam({liveId:y["a"].getUrl("liveId"),appType:y["a"].getUrl("appType")});case 10:t=e.sent,this.commonparams=t,this.flag=!0;case 13:return i={pageNo:this.pageNo,pageSize:this.pageSize,liveId:this.commonparams.liveId,userId:this.userInfo?this.userInfo.uid:"",userType:this.realuserType,viewType:1,studentId:this.userInfo?this.userInfo.student_uid:"",babyId:this.userInfo?this.userInfo.uid:""},e.prev=14,e.next=17,g["c"].getCommentList(i);case 17:r=e.sent,setTimeout((function(){r.list.length>0?(a.list=a.list.concat(r.list),a.pageNo++):0===r.list.length&&(a.nodatashow=!0,a.finished=!0),(r.totalPages<a.pageNo||r.list.length<20)&&(a.finished=!0),a.loading=!1}),500),e.next=26;break;case 21:e.prev=21,e.t0=e["catch"](14),this.nodatashow=!0,this.refreshing=!1,this.finished=!0;case 26:case"end":return e.stop()}}),e,this,[[14,21]])})));function t(){return e.apply(this,arguments)}return t}(),onRefresh:function(){var e=this;setTimeout((function(){e.finished=!1,e.refreshing=!1,e.list=[],e.pageNo=1,e.onLoad()}),500)}})},B=A,J=(i("eeea"),i("c44a"),i("051d"),Object(p["a"])(B,$,U,!1,null,"1c18d079",null)),W=J.exports,Q=i("0778"),q=i("398f");function H(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function G(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?H(Object(i),!0).forEach((function(t){Object(s["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var K={data:function(){return{tabIndex:1,urlParams:G({},this.$route.query),playerOpt:{src:"",poster:"",beginTime:0,liveStatus:0,liveTitle:""},liveInfo:{},rewardShow:0,reportingTime:0,rewardSwitch:0,vodList:[],errorCode:0,desc:"",tabbarItems:[{label:"互动",value:1},{label:"简介",value:2}],dateNow:Date.now(),timer:null,isInit:!1,imInitData:{layout:"horizontal",groupID:this.$route.query.groupId,SDKAppID:"",userID:"",userSig:"",zanNums:0,visitsNums:0,userInfo:{userName:"",userAvatar:""},giftInfo:{enable:!0,type:1},commonConfig:{forbiddenTime:7200,giveLikeRate:3e3,sendRate:500}},liveFlag:!1}},components:{vPlayer:o["a"],vTabbar:h,reward:T,Introduce:P,VodList:L,Interactive:W,CustomMessage:Q["a"]},computed:{isOld:function(){return y["a"].versionCompare(this.urlParams.appVer||"6.1.1","6.24")<0},componentId:function(){var e="";switch(this.tabIndex){case 1:e=this.isOld?"Interactive":"CustomMessage";break;case 2:e="Introduce";break;case 3:e="VodList";break}return e}},created:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getLiveRoomInfo();case 2:return e.next=4,this.getDesc();case 4:return e.next=6,this.getUserSign();case 6:return e.next=8,this.getImConf();case 8:this.pvShareReport();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),beforeMount:function(){},mounted:function(){this.$bus.$on("onLivePlayEnd",this.onLivePlayEnd.bind(this))},methods:{getUserSign:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=JSON.parse(window.localStorage.getItem("wx_user_info")),e.prev=1,e.next=4,g["b"].getUserSign({openId:t.openid});case 4:i=e.sent,r=i.userid,a=i.usersign,n=i.sdkappid,this.imInitData.userID=r,this.imInitData.userSig=a,this.imInitData.SDKAppID=n,this.imInitData.userInfo={userName:t.nickname,userAvatar:t.headimgurl},window.SDKAppID=n,window.tim=this.TIM.create({SDKAppID:n}),this.isInit=!0,e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](1),console.log(e.t0);case 20:case"end":return e.stop()}}),e,this,[[1,17]])})));function t(){return e.apply(this,arguments)}return t}(),getLiveRoomInfo:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var i,r,a,n,s,o,c,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=this.urlParams.liveId,r=JSON.parse(window.localStorage.getItem("wx_user_info")),a=r.openid,e.prev=2,e.next=5,g["d"].getLiveRoomInfo({liveId:i,shareUrl:window.location.href,openId:a},{headers:{sessionId:""}});case 5:n=e.sent,s=n.playInfo,o=n.vodList,c=n.vodlist,l=n.reportingTime,u=n.rewardSwitch,d=n.redEnvelopeSwitch,p=n.giftSwitch,this.playerOpt.liveStatus=s.liveState,this.playerOpt.src=s.hlsPlayUrl||"no live",this.playerOpt.beginTime=s.liveBeginTime||0,this.playerOpt.poster=s.liveBackground,this.playerOpt.liveTitle=s.liveTitle,2===this.playerOpt.liveStatus?(this.errorCode=t?1:2,this.timer&&clearInterval(this.timer)):this.errorCode=0,this.vodList=o||c,this.reportingTime=l,this.imInitData.giftInfo.enable=1*u===1,1*p===1?this.imInitData.giftInfo.type=1:1*d===1&&(this.imInitData.giftInfo.type=2),this.imInitData.zanNums=s.liveThumbsupCount||0,this.imInitData.visitsNums=s.liveWatchUsersNum||0,1*s.liveState===2&&(this.tabbarItems=[{label:"互动",value:1},{label:"简介",value:2},{label:"精彩内容",value:3}]),t||(document.title=s.liveTitle,q["b"].$emit("setShareData",{title:s.liveShareInfo.msgTitle,desc:s.liveShareInfo.summary,imgUrl:s.liveShareInfo.shareMsgUrl})),e.next=34;break;case 29:throw e.prev=29,e.t0=e["catch"](2),this.playerOpt.src="no live",this.errorCode=3,e.t0;case 34:case"end":return e.stop()}}),e,this,[[2,29]])})));function t(t){return e.apply(this,arguments)}return t}(),getDesc:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.urlParams.liveId,e.prev=1,e.next=4,g["d"].getDesc({liveId:t});case 4:i=e.sent,r=i.liveIntroduction,this.desc=r,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),playError:function(){var e=this,t=setTimeout(Object(n["a"])(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.getLiveRoomInfo(!0);case 2:r=e.playerOpt.liveStatus,1===r?setTimeout((function(){window.location.reload()}),1e3):e.playError(),clearTimeout(t);case 5:case"end":return i.stop()}}),i)}))),1e3)},updateIMItem:function(e){console.log("*+*+*+*+*+*+*+*+"),console.log(e),this.$refs["current-message"].sendGift({msgInfo:e.msgInfo})},onTabbarChange:function(e){switch(this.tabIndex=e,e){case 1:this.pvShareReport();break;case 2:this.pvShareReport("introduction");break;case 3:this.pvShareReport("video");break}},setRewardVisible:function(e){this.rewardShow=e;var t=1===this.imInitData.giftInfo.type?"gift":"redpacket",i={fromtype:3,type:2,livetype:2};window.szyreport.reportPV({data:{status:"",trial:"",stay_time:"",progress:"",page_category:"3",page:"openclass_main",page_id:"",parm:JSON.stringify(i),f_page:"",f_page_id:"",f_page_location:t},prefix:""}),this.$szyreport.reportEvent({data:{event_id:"click_openclass_"+t,obj_id:y["a"].getUrl("liveId"),parm:{client:3}},prefix:""})},loadVideo:function(e){var t=this,i=e.item;this.$refs.player.player.load(i.playUrl||i.playurl),this.$refs.player.player.play();var r=setTimeout((function(){t.$refs.player.isError=!1,clearTimeout(r)}),100);this.reportStartPlay("VIDEO",1,i.vodId||i.vodid),this.reportTime(1,i.vodId||i.vodid)},reportTime:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";this.timer&&clearInterval(this.timer),this.timer=setInterval(Object(n["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=JSON.parse(window.localStorage.getItem("wx_user_info")),n=a.openid,s={liveId:e.urlParams.liveId,watchType:t,terminalType:2,vodId:i,userType:2,openId:n},r.prev=2,r.next=5,g["d"].reportTime(s);case 5:r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](2),console.log(r.t0);case 10:case"end":return r.stop()}}),r,null,[[2,7]])}))),60*this.reportingTime*1e3)},reportStartPlay:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,r,a,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"LIVE",i=n.length>1&&void 0!==n[1]?n[1]:0,r=n.length>2?n[2]:void 0,a={liveId:this.urlParams.liveId,watchType:i,userType:2,vodId:r},e.prev=4,e.next=7,g["d"].reportPlayStart(t,a);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](4),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[4,9]])})));function t(){return e.apply(this,arguments)}return t}(),playStart:function(){this.reportTime()},playPause:function(){this.timer&&clearInterval(this.timer)},pvShareReport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"livechat",t=this.urlParams.liveId,i=window.location.origin,r=i.includes("alpha")||i.includes("dev")?"alpha":"";window.szyreport.reportPV({data:{page_category:3,page:"openclass_main",page_id:t,parm:JSON.stringify({fromtype:"3",type:"2",livetype:"1"}),f_page_location:e},prefix:r})},getImConf:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g["d"].getImConf();case 3:t=e.sent,i=t.configInfo,Object.assign(this.imInitData.commonConfig,i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}(),countDownRun:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getLiveRoomInfo();case 2:t=this.playerOpt.liveStatus,1===t&&setTimeout((function(){window.location.reload()}),3e4);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onLivePlayEnd:function(e){1!==+e.state&&(this.errorCode=1,this.timer&&clearInterval(this.timer))}},beforeRouteLeave:function(e,t,i){var r={clientInfo:{type:3,version:this.urlParams.appVer},senderInfo:{userType:0,userId:this.imInitData.userID,userName:this.imInitData.userInfo.userName,userAvatar:this.imInitData.userInfo.userAvatar},businessInfo:{id:3,type:2},msgInfo:{type:2,body:{streamId:this.urlParams.streamId,joinType:2,joinTip:"退出了直播"}}};g["b"].sendBusinessMsg({groupId:this.imInitData.groupID,msgBody:[{msgType:"TIMCustomElem",msgContent:{data:JSON.stringify(r)}}],fromAccount:this.imInitData.userID}).catch((function(e){console.log(e)})),window.tim.quitGroup(this.imInitData.groupID).catch((function(){console.log("applyQuitGroup 错误")})),i()}},X=K,Y=(i("57fb"),Object(p["a"])(X,r,a,!1,null,null,null));t["default"]=Y.exports},"2cb0":function(e,t,i){e.exports=i.p+"static/img/icon_qs1@3x.11046251.png"},"303c":function(e,t,i){e.exports=i.p+"static/img/Mom.1c07c90b.png"},3061:function(e,t,i){},3366:function(e,t,i){},3788:function(e,t,i){},"3a2f":function(e,t,i){"use strict";var r=i("3366"),a=i.n(r);a.a},"3c3f":function(e,t,i){"use strict";var r=i("6f87"),a=i.n(r);a.a},4296:function(e,t,i){},"4eb9":function(e,t,i){"use strict";var r=i("fd9c"),a=i.n(r);a.a},"4fd6":function(e,t,i){e.exports=i.p+"static/img/teacher.c55542a7.png"},"521e":function(e,t,i){},"54f0":function(e,t,i){"use strict";var r=i("ba3e"),a=i.n(r);a.a},"57fb":function(e,t,i){"use strict";var r=i("521e"),a=i.n(r);a.a},"5c95":function(e,t,i){e.exports=i.p+"static/img/Dad.83eb0b34.png"},"6f87":function(e,t,i){},"79b1":function(e,t,i){e.exports=i.p+"static/img/logo@2x.02a8a5b3.png"},"9e76":function(e,t,i){"use strict";var r=i("69b3"),a=i("eafa"),n=i("e754"),s=i("7108");i("0aed")("match",1,(function(e,t,i,o){return[function(i){var r=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,r):new RegExp(i)[t](String(r))},function(e){var t=o(i,e,this);if(t.done)return t.value;var c=r(e),l=String(this);if(!c.global)return s(c,l);var u=c.unicode;c.lastIndex=0;var d,p=[],f=0;while(null!==(d=s(c,l))){var h=String(d[0]);p[f]=h,""===h&&(c.lastIndex=n(l,a(c.lastIndex),u)),f++}return 0===f?null:p}]}))},b27f:function(e,t,i){(function(e){var r="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function n(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new n(a.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new n(a.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i("de8a"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i("77e5"))},ba3e:function(e,t,i){},baa9:function(e,t,i){},c44a:function(e,t,i){"use strict";var r=i("3061"),a=i.n(r);a.a},de8a:function(e,t,i){(function(e,t){(function(e,i){"use strict";if(!e.setImmediate){var r,a=1,n={},s=!1,o=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?f():h()?m():e.MessageChannel?v():o&&"onreadystatechange"in o.createElement("script")?g():y(),c.setImmediate=l,c.clearImmediate=u}function l(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var s={callback:e,args:t};return n[a]=s,r(a),a++}function u(e){delete n[e]}function d(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(i,r);break}}function p(e){if(s)setTimeout(p,0,e);else{var t=n[e];if(t){s=!0;try{d(t)}finally{u(e),s=!1}}}}function f(){r=function(e){t.nextTick((function(){p(e)}))}}function h(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}function m(){var t="setImmediate$"+Math.random()+"$",i=function(i){i.source===e&&"string"===typeof i.data&&0===i.data.indexOf(t)&&p(+i.data.slice(t.length))};e.addEventListener?e.addEventListener("message",i,!1):e.attachEvent("onmessage",i),r=function(i){e.postMessage(t+i,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;p(t)},r=function(t){e.port2.postMessage(t)}}function g(){var e=o.documentElement;r=function(t){var i=o.createElement("script");i.onreadystatechange=function(){p(t),i.onreadystatechange=null,e.removeChild(i),i=null},e.appendChild(i)}}function y(){r=function(e){setTimeout(p,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,i("77e5"),i("4c39"))},e02d:function(e,t,i){"use strict";var r=i("4296"),a=i.n(r);a.a},eeea:function(e,t,i){"use strict";var r=i("baa9"),a=i.n(r);a.a},fd9c:function(e,t,i){},fe7f:function(e,t,i){e.exports=i.p+"static/img/poster-ver.7dbe3503.png"}}]);